{"ast":null,"code":"import React,{useState}from'react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Step1=_ref=>{let{formData,handleInputChange,handleNext}=_ref;const[emailValid,setEmailValid]=useState(false);const[errorMessage,setErrorMessage]=useState('');const[otpSent,setOtpSent]=useState(false);const[loading,setLoading]=useState(false);// To show a loading indicator when sending OTP\nconst validateAndSendOtp=async()=>{if(formData.email&&/\\S+@\\S+\\.\\S+/.test(formData.email)){setLoading(true);// Start loading when the button is clicked\ntry{// Validate if the email is new\nconst response=await fetch('https://api.huberway.com/auth/is-new-email',{method:'POST',body:JSON.stringify({email:formData.email}),headers:{'Content-Type':'application/json'}});const result=await response.json();if(result.type==='registered'){setErrorMessage('This email is already registered.');setEmailValid(false);setLoading(false);// Stop loading\n}else{setEmailValid(true);setErrorMessage('');// Email is valid, now send the OTP\nconst otpResponse=await sendOtp(formData.email);if(otpResponse){handleNext();// Go to the next step after sending OTP\n}else{setLoading(false);// Stop loading if OTP fails\n}}}catch(error){setErrorMessage('Error while verifying email.');setLoading(false);// Stop loading on error\n}}else{setErrorMessage('Invalid email format.');setEmailValid(false);setLoading(false);// Stop loading\n}};const sendOtp=async email=>{try{const response=await fetch('https://api.huberway.com/auth/send-mail-verify',{method:'POST',body:JSON.stringify({email}),headers:{'Content-Type':'application/json'}});const result=await response.json();console.log(result.message);if(result.message=='success'){setOtpSent(true);setErrorMessage('');return true;// OTP sent successfully\n}else{setErrorMessage('Failed to send OTP. Please try again.');return false;// OTP failed\n}}catch(error){setErrorMessage('Error while sending OTP.');return false;}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12 head-register\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Create your free account\"}),/*#__PURE__*/_jsx(\"h5\",{children:\"100% free. No credit card needed.\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row mb-20\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email address\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:formData.email,onChange:handleInputChange,className:\"form-control\",required:true}),errorMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"text-danger\",children:errorMessage})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:validateAndSendOtp,disabled:loading// Disable the button when loading\n,className:\"btn btn-primary btn-cons m-t-10 btn-login\",children:loading?'Sending OTP...':'Verify Email'}),otpSent&&/*#__PURE__*/_jsx(\"p\",{children:\"OTP has been sent to your email address. Please check your inbox.\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-information\",children:[\"We\\u2019re committed to your privacy. Huberway uses the information you provide to us to contact you about our relevant content, products, and services. You may unsubscribe from these communications at any time. For more information, check out our \",/*#__PURE__*/_jsx(\"a\",{href:\"#\",children:\"Privacy Policy\"}),\".\"]})]});};export default Step1;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Step1","_ref","formData","handleInputChange","handleNext","emailValid","setEmailValid","errorMessage","setErrorMessage","otpSent","setOtpSent","loading","setLoading","validateAndSendOtp","email","test","response","fetch","method","body","JSON","stringify","headers","result","json","type","otpResponse","sendOtp","error","console","log","message","children","className","name","value","onChange","required","onClick","disabled","href"],"sources":["/Users/macbookpro/Documents/Piattaforme-Huberway/Authentication/src/pages/Step1.js"],"sourcesContent":["import React, { useState } from 'react';\n\nconst Step1 = ({ formData, handleInputChange, handleNext }) => {\n  const [emailValid, setEmailValid] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [otpSent, setOtpSent] = useState(false);\n  const [loading, setLoading] = useState(false); // To show a loading indicator when sending OTP\n\n  const validateAndSendOtp = async () => {\n    if (formData.email && /\\S+@\\S+\\.\\S+/.test(formData.email)) {\n      setLoading(true); // Start loading when the button is clicked\n      try {\n        // Validate if the email is new\n        const response = await fetch('https://api.huberway.com/auth/is-new-email', {\n          method: 'POST',\n          body: JSON.stringify({ email: formData.email }),\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        });\n        const result = await response.json();\n\n        if (result.type === 'registered') {\n          setErrorMessage('This email is already registered.');\n          setEmailValid(false);\n          setLoading(false); // Stop loading\n        } else {\n          setEmailValid(true);\n          setErrorMessage('');\n\n          // Email is valid, now send the OTP\n          const otpResponse = await sendOtp(formData.email);\n\n          if (otpResponse) {\n            handleNext(); // Go to the next step after sending OTP\n          } else {\n            setLoading(false); // Stop loading if OTP fails\n          }\n        }\n      } catch (error) {\n        setErrorMessage('Error while verifying email.');\n        setLoading(false); // Stop loading on error\n      }\n    } else {\n      setErrorMessage('Invalid email format.');\n      setEmailValid(false);\n      setLoading(false); // Stop loading\n    }\n  };\n\n  const sendOtp = async (email) => {\n    try {\n      const response = await fetch('https://api.huberway.com/auth/send-mail-verify', {\n        method: 'POST',\n        body: JSON.stringify({ email }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n      const result = await response.json();\n      console.log(result.message);\n      if (result.message == 'success') {\n        setOtpSent(true);\n        setErrorMessage('');\n        return true; // OTP sent successfully\n      } else {\n        setErrorMessage('Failed to send OTP. Please try again.');\n        return false; // OTP failed\n      }\n    } catch (error) {\n      setErrorMessage('Error while sending OTP.');\n      return false;\n    }\n  };\n\n  return (\n    <>\n      <div className=\"row\">\n        <div className=\"col-md-12 head-register\">\n          <h1>Create your free account</h1>\n          <h5>100% free. No credit card needed.</h5>\n        </div>\n      </div>\n\n      <div className=\"row mb-20\">\n        <div className=\"col-md-12\">\n          <label>Email address</label>\n          <input\n            type=\"email\"\n            name=\"email\"\n            value={formData.email}\n            onChange={handleInputChange}\n            className=\"form-control\"\n            required\n          />\n          {errorMessage && <div className=\"text-danger\">{errorMessage}</div>}\n        </div>\n      </div>\n\n      <button\n        onClick={validateAndSendOtp}\n        disabled={loading} // Disable the button when loading\n        className=\"btn btn-primary btn-cons m-t-10 btn-login\"\n      >\n        {loading ? 'Sending OTP...' : 'Verify Email'}\n      </button>\n\n      {/* Information message after OTP is sent */}\n      {otpSent && <p>OTP has been sent to your email address. Please check your inbox.</p>}\n\n      <p className=\"text-information\">\n        Weâ€™re committed to your privacy. Huberway uses the information you provide to us to contact you\n        about our relevant content, products, and services. You may unsubscribe from these communications\n        at any time. For more information, check out our <a href=\"#\">Privacy Policy</a>.\n      </p>\n    </>\n  );\n};\n\nexport default Step1;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}