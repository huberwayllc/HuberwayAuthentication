{"ast":null,"code":"import React,{useState,useRef}from'react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Step2=_ref=>{let{formData,handleInputChange,handleNext,handleBack}=_ref;const[otp,setOtp]=useState(Array(6).fill(''));const inputRefs=useRef([]);// Handle change for OTP input\nconst handleOtpChange=(e,index)=>{const newOtp=[...otp];const{value}=e.target;if(/^[0-9]?$/.test(value)){newOtp[index]=value;setOtp(newOtp);// Move to next input if not the last one and value is valid\nif(value&&index<5){inputRefs.current[index+1].focus();}}};// Handle backspace to move to previous input field\nconst handleKeyDown=(e,index)=>{if(e.key==='Backspace'&&!otp[index]&&index>0){inputRefs.current[index-1].focus();}};// Handle OTP paste\nconst handlePaste=e=>{const pasteData=e.clipboardData.getData('text').slice(0,6);const newOtp=[...otp];// Paste OTP code into the fields, focus the last filled field\npasteData.split('').forEach((char,index)=>{if(/^[0-9]$/.test(char)){newOtp[index]=char;}});setOtp(newOtp);// Focus the next input after the last filled one\nconst nextIndex=pasteData.length<6?pasteData.length:5;inputRefs.current[nextIndex].focus();};// Verify OTP\nconst verifyOtp=async()=>{const otpValue=otp.join('');const response=await fetch('https://api.huberway.com/auth/verify-mail',{method:'POST',body:JSON.stringify({email:formData.email,otp:otpValue}),headers:{'Content-Type':'application/json'}});const result=await response.json();return result.type!=='failed';};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleBack,className:\"back\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fal fa-chevron-left\"}),\" Back\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12 head-register\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Check your email address\"}),/*#__PURE__*/_jsxs(\"h5\",{children:[\"Enter the verification code sent to: \",/*#__PURE__*/_jsx(\"b\",{children:formData.email})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"row mb-20\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"otp-form\",style:{margin:`auto`,alignItems:`center`},onPaste:handlePaste,children:otp.map((value,index)=>/*#__PURE__*/_jsx(\"input\",{ref:el=>inputRefs.current[index]=el,className:\"otp-field\",type:\"text\",value:value,maxLength:1,onChange:e=>handleOtpChange(e,index),onKeyDown:e=>handleKeyDown(e,index),autoComplete:\"off\",style:{textAlign:'center',width:'13%',marginRight:'5px'}},index))}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{const validOtp=await verifyOtp();if(validOtp)handleNext();},disabled:otp.join('').length<6,className:\"btn btn-primary btn-cons m-t-10 btn-login\",children:\"Next\"})]})]});};export default Step2;","map":{"version":3,"names":["React","useState","useRef","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Step2","_ref","formData","handleInputChange","handleNext","handleBack","otp","setOtp","Array","fill","inputRefs","handleOtpChange","e","index","newOtp","value","target","test","current","focus","handleKeyDown","key","handlePaste","pasteData","clipboardData","getData","slice","split","forEach","char","nextIndex","length","verifyOtp","otpValue","join","response","fetch","method","body","JSON","stringify","email","headers","result","json","type","children","onClick","className","style","margin","alignItems","onPaste","map","ref","el","maxLength","onChange","onKeyDown","autoComplete","textAlign","width","marginRight","validOtp","disabled"],"sources":["/Users/macbookpro/Documents/Piattaforme-Huberway/Authentication/src/pages/Step2.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\n\nconst Step2 = ({ formData, handleInputChange, handleNext, handleBack }) => {\n  const [otp, setOtp] = useState(Array(6).fill(''));\n  const inputRefs = useRef([]);\n\n  // Handle change for OTP input\n  const handleOtpChange = (e, index) => {\n    const newOtp = [...otp];\n    const { value } = e.target;\n\n    if (/^[0-9]?$/.test(value)) {\n      newOtp[index] = value;\n      setOtp(newOtp);\n\n      // Move to next input if not the last one and value is valid\n      if (value && index < 5) {\n        inputRefs.current[index + 1].focus();\n      }\n    }\n  };\n\n  // Handle backspace to move to previous input field\n  const handleKeyDown = (e, index) => {\n    if (e.key === 'Backspace' && !otp[index] && index > 0) {\n      inputRefs.current[index - 1].focus();\n    }\n  };\n\n  // Handle OTP paste\n  const handlePaste = (e) => {\n    const pasteData = e.clipboardData.getData('text').slice(0, 6);\n    const newOtp = [...otp];\n\n    // Paste OTP code into the fields, focus the last filled field\n    pasteData.split('').forEach((char, index) => {\n      if (/^[0-9]$/.test(char)) {\n        newOtp[index] = char;\n      }\n    });\n\n    setOtp(newOtp);\n\n    // Focus the next input after the last filled one\n    const nextIndex = pasteData.length < 6 ? pasteData.length : 5;\n    inputRefs.current[nextIndex].focus();\n  };\n\n  // Verify OTP\n  const verifyOtp = async () => {\n    const otpValue = otp.join('');\n    const response = await fetch('https://api.huberway.com/auth/verify-mail', {\n      method: 'POST',\n      body: JSON.stringify({ email: formData.email, otp: otpValue }),\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n    const result = await response.json();\n    return result.type !== 'failed';\n  };\n\n  return (\n    <>\n      <button onClick={handleBack} className=\"back\">\n        <i className=\"fal fa-chevron-left\"></i> Back\n      </button>\n      <div className=\"row\">\n        <div className=\"col-md-12 head-register\">\n          <h1>Check your email address</h1>\n          <h5>Enter the verification code sent to: <b>{formData.email}</b></h5>\n        </div>\n      </div>\n      <div className=\"row mb-20\">\n        <div className=\"otp-form\" style={{ margin: `auto`, alignItems: `center` }} onPaste={handlePaste}>\n          {otp.map((value, index) => (\n            <input\n              key={index}\n              ref={(el) => (inputRefs.current[index] = el)}\n              className=\"otp-field\"\n              type=\"text\"\n              value={value}\n              maxLength={1}\n              onChange={(e) => handleOtpChange(e, index)}\n              onKeyDown={(e) => handleKeyDown(e, index)}\n              autoComplete=\"off\"\n              style={{ textAlign: 'center', width: '13%', marginRight: '5px' }}\n            />\n          ))}\n        </div>\n        <button\n          onClick={async () => {\n            const validOtp = await verifyOtp();\n            if (validOtp) handleNext();\n          }}\n          disabled={otp.join('').length < 6}\n          className=\"btn btn-primary btn-cons m-t-10 btn-login\"\n        >\n          Next\n        </button>\n      </div>\n    </>\n  );\n};\n\nexport default Step2;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}